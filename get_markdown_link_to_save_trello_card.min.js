!function(){function e(e,o,t){var i=window,c=encodeURIComponent("- ["+g+"]("+f+")")+(t?encodeURIComponent("\n\n----\n\n ```\n"+t+"\n```"):"");i.open("https://trello.com/add-card?source="+i.location.host+"&mode=popup&url="+encodeURIComponent(e)+(o?"&name="+encodeURIComponent(o):"")+"&desc="+c,"add-trello-card","width=500,height=600,left="+(i.screenX+(i.outerWidth-500)/2)+",top="+(i.screenY+(i.outerHeight-740)/2))}var o=1,t=1,i=1,c=1,a="nico.ms",r=0;try{r="localStorage"in window&&null!==window.localStorage}catch(n){r=!1}for(var l="",p=document.getElementsByTagName("link"),h=p.length;h--;)"shortlink"==p[h].rel&&(l=p[h].href);if(-1!=location.href.indexOf("//www.youtube.com/watch?")&&(l=location.href.replace(/.*youtube\.com\/watch\?v=(.*)\&(.*)/,"https://youtu.be/$1?$2")),-1!=location.href.indexOf("//www.pixiv.net/member.php?id="))for(p=document.getElementsByTagName("input"),h=p.length;h--;)if(/http\:\/\/pixiv\.me\/.*/.test(p[h].value)){l=""==l?p[h].value:l;break}if(-1!=location.href.indexOf("//www.pixiv.net/member_illust.php?")){p=document.getElementsByTagName("link"),h=p.length;for(var d=document.getElementsByTagName("html")[0].lang.length>0?document.getElementsByTagName("html")[0].lang:"";h--;)if("en"==p[h].hreflang){l=""==l?p[h].href.replace(/www(\.pixiv\.com)/,d+"$1"):l;break}}if(-1!=location.href.indexOf("//dic.nicovideo.jp"))for(p=document.getElementsByTagName("a"),h=p.length;h--;)if(/.*\/id\/(\d+)/.test(p[h].href)){l=""==l?p[h].href.replace(/.*\/id\/(\d+)/,"http://nico.ms/dic/$1"):l;break}if(r&&!i){var m="undefined"==typeof localStorage.short_yes?c:"true"==localStorage.short_yes?1:0,w=null;if("undefined"!=typeof window.localStorage){"true"!=localStorage.rember_set_&&(""==l?((-1!=location.href.indexOf("//www.nicovideo.jp")||-1!=location.href.indexOf("//dic.nicovideo.jp/id")||-1!=location.href.indexOf("//news.nicovideo.jp/watch")||-1!=location.href.indexOf("//commons.nicovideo.jp/material")||-1!=location.href.indexOf("//jk.nicovideo.jp/watch")||-1!=location.href.indexOf("//app.nicovideo.jp/app")||-1!=location.href.indexOf("//ichiba.nicovideo.jp/item")||-1!=location.href.indexOf("//chokuhan.nicovideo.jp/products/detail/")||/ch\.nicovideo\.jp\/.*\/blomaga\/ar.*/.test(location.href)||-1!=location.href.indexOf("//com.nicovideo.jp")||-1!=location.href.indexOf("//live.nicovideo.jp")||-1!=location.href.indexOf("//seiga.nicovideo.jp")||-1!=location.href.indexOf("//nico.ms"))&&(m=confirm("請問ニコニコ動画相關網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)),-1==location.href.indexOf("//www.facebook.com")&&-1==location.href.indexOf("//fb.com")||(m=confirm("請問 www.facebook.com 相關網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)),-1!=location.href.indexOf("//www.pixiv.net/member.php?id=")&&(m=confirm("請問 pixiv.net 使用者網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)),-1!=location.href.indexOf("//bangumi.tv")&&(m=confirm("請問 bangumi.tv 相關網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)),-1!=location.href.indexOf("//www.bilibili.com")&&(m=confirm("請問 嗶哩嗶哩 相關網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)),-1==location.href.indexOf("//trello.com/b")&&-1==location.href.indexOf("//trello.com/c")||(m=confirm("請問 Trello 相關網址要縮成短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m))):(m=confirm("請問要直接使用這個網站本身提供的短網址嗎？"),localStorage.rember_set_=confirm("請問下次可以不要詢問「是否縮短網址」的問題，\n直接沿用剛剛的回答？"),"true"==localStorage.rember_set_&&(localStorage.short_yes=m)));var s="undefined"!=typeof localStorage.always_no_rem?"true"!=localStorage.always_no_rem:confirm("請問需要加入註解嗎？");if(s){var w=window.prompt("【為 Markdown 連結標示註解提示文字】\n\n這是稍後要組合出 Markdown 連結時，要用的註解文字。\n效果是滑鼠停留在連結上時，會出現這段說明文字。\n已有預設值你可自行修改，也可取消就不會使用註解。",document.title.replace(/( - ニコニコ動画:GINZA| ‐ ニコニコ動画:GINZA| ‐ niconico動畫:GINZA| - Niconico Douga: Ginza)/,""));null!=w&&""!=w||confirm("請問以後執行時，可以都不加入註解嗎？")&&(localStorage.always_no_rem="true")}"undefined"==typeof localStorage.always_no_rem&&confirm("下次可以直接沿用剛才「是否加入註解」的決定嗎？")&&(localStorage.always_no_rem=!s)}}else var m=c,w=null;var f=(1==m?""==l?location.href.replace(/https?\:\/\/www\.nicovideo\.jp\/watch\//,"http://"+a+"/").replace(/https?\:\/\/seiga\.nicovideo\.jp\/(seiga|watch)\//,"http://"+a+"/").replace(/https?\:\/\/live\.nicovideo\.jp\/watch\//,"http://"+a+"/").replace(/https?\:\/\/com\.nicovideo\.jp\/community\//,"http://"+a+"/").replace(/https?\:\/\/ch\.nicovideo\.jp\/.*\/blomaga\/(ar.*)/,"http://"+a+"/$1").replace(/https?\:\/\/chokuhan\.nicovideo\.jp\/products\/detail\/(\d*)/,"http://"+a+"/nd$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(az.*)/,"http://"+a+"/$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(ysamiami.*)/,"http://"+a+"/$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(ggbo.*)/,"http://"+a+"/$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(ndsupplier.*)/,"http://"+a+"/$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(dw.*)/,"http://"+a+"/$1").replace(/https?\:\/\/ichiba\.nicovideo\.jp\/item\/(it.*)/,"http://"+a+"/$1").replace(/https?\:\/\/app\.nicovideo\.jp\/app\/(ap.*)/,"http://"+a+"/$1").replace(/https?\:\/\/jk\.nicovideo\.jp\/watch\/(jk.*)/,"http://"+a+"/$1").replace(/https?\:\/\/commons\.nicovideo\.jp\/material\/(nc.*)/,"http://"+a+"/$1").replace(/https?\:\/\/news\.nicovideo\.jp\/watch\/(nw.*)/,"http://"+a+"/$1").replace(/https?\:\/\/www\.nicovideo\.jp\/(user\/\d*)/,"http://"+a+"/$1").replace(/https?\:\/\/www\.nicovideo\.jp\/(mylist\/\d*)/,"http://"+a+"/$1").replace(/https?\:\/\/www\.nicovideo/,"http://nicovideo").replace(/https?\:\/\/www\.facebook\.com/,"http://fb.com").replace(/https?\:\/\/www\.pixiv\.net\/member\.php\?id\=/,"http://p.tl/m/").replace(/https?\:\/\/www\.pixiv/,"http://pixiv").replace("http://bangumi.tv","http://bgm.tv").replace(/https?\:\/\/www\.bilibili\.com/,"http://acg.tv").replace(/(https?:\/\/trello\.com\/(c|b)\/.*)\/.*/,"$1").replace(/(https?)\:\/\/www\.plurk/,"$1://plurk").replace(/(https?)\:\/\/www\.playpcesor/,"$1://playpcesor").replace(/:\/\/.*\.(googledrive\.com.{0,})/,"://$1"):l:location.href.replace(/(https?)\:\/\/www\.plurk/,"$1://plurk").replace(/https?\:\/\/www\.facebook/,"http://facebook").replace(/https?\:\/\/www\.pixiv/,"http://pixiv").replace(/https?\:\/\/www\.nicovideo/,"http://nicovideo").replace(/https?\:\/\/www\.bilibili/,"http://bilibili").replace(/(https?)\:\/\/www\.playpcesor/,"$1://playpcesor").replace(/:\/\/.*\.(googledrive\.com.{0,})/,"://$1"))+(null==w||""==w?"":' "'+w+'"'),g=document.title.replace(/( - ニコニコ動画:GINZA| ‐ ニコニコ動画:GINZA| ‐ niconico動畫:GINZA| - Niconico Douga: Ginza)/,"").replace(/( - 哔哩哔哩 - \( ゜- ゜\)つロ 乾杯~ - bilibili| - 嗶哩嗶哩 - \( ゜- ゜\)つロ 乾杯~ - bilibili)/,"").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/http\:/g,"http\\:").replace(/https\:/g,"https\\:").replace(/\_/g,"\\_").replace(/\#/g,"\\#").replace(/\*/g,"\\*");if(0==o){var v=window.prompt("這是目前網頁的標題 + 網址。\n並以 Markdown 的語法寫成連結。"+(-1!=location.href.indexOf("//www.nicovideo.jp")||-1!=location.href.indexOf("//nico.ms")?"\n\n另外標題已自動排除部分字樣：\n「 - ニコニコ動画:GINZA」":""),"["+g+"]("+f+")");null==v&&(t=0)}if(null!=navigator.userAgent.match("MSIE")&&null!=v&&""!=v&&window.clipboardData.setData("Text",v),console.log(v),1==t){var u=(window.location.href,document.title,getSelection?getSelection().toString():"");-1!=location.href.indexOf("//www.youtube.com/watch?")&&(f=location.href),e(f,g,u)}}();